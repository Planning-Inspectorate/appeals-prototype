{% extends "layout.html" %}

{% block beforeContent %}
	{{ govukPhaseBanner({
		tag: { text: 'Beta' },
		html: 'This is a new service &ndash; your <a class="govuk-link" href="#feedback">feedback</a> will help us to improve it.'
	}) }}
	
	{{ govukBackLink({
		html: 'Back',
		href: 'javascript:history.back()'
	}) }}
{% endblock %}

{% block content %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      <form method="post">

        {# Create an array for the LPA select below #}
        {% set lpaList = [{value: '',text: 'Select LPA'}] %}

        {# Include all of the LPA's which are set in default data #}
        {% for lpa in data['lpas'] %}
          {% set lpaList = lpaList | push ({
            value: lpa['official-name'],
            text: lpa['official-name']
          }) %}
        {% endfor %}

        {# Adds all items from the array then progressively enhanced with the script at the bottom of the file #}
        {{ govukSelect({
          id: 'lpa',
          name: 'lpa',
          label: {
            html: 'Which local planning authority dealt with your lawful development certificate?',
            classes: 'govuk-label--l',
            isPageHeading: true
          },
          hint: {
            html: 'This is also known as your &lsquo;local planning department&rsquo; or &lsquo;LPA&rsquo;'
          },
          items: lpaList,
          attributes: {
            'data-default-value': data['lpa']
          }
        }) }}

        {{ govukButton({
          html: 'Continue'
        }) }}

      </form>
    </div>
  </div>
{% endblock %}

{% block pageScripts %}
  {# Enhance the select to a typeahead #}
  <script>
    let selectElement = document.querySelector('#lpa')

    accessibleAutocomplete.enhanceSelectElement({
      defaultValue: selectElement.getAttribute('data-default-value'),
      selectElement: selectElement
    })
  </script>
{% endblock %}