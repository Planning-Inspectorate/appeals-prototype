<style>
  .filters-container {
    background: #f3f2f1;
    padding: 20px;
  }

  .filters-inner {
    display: grid;
    grid-template-columns: 1fr;
    gap: 24px;
  }

  @media (min-width: 40.0625em) {
    .filters-inner {
      grid-template-columns: 1fr 1fr;
    }
  }

  .app-applied-filters {
    background: #f3f2f1;
    border: 1px solid #b1b4b6;
    padding: 15px;
    margin: 15px 0;
  }

  .app-applied-filters__header {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .app-applied-filters__chips {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-top: 10px;
  }

  .app-chip {
    display: inline-flex;
    align-items: center;
    background: white;
    border: 1px solid #b1b4b6;
    padding: 6px 12px;
    border-radius: 5px;
  }

  .app-chip__remove {
    background: none;
    border: none;
    font-size: 18px;
    margin-left: 8px;
    cursor: pointer;
  }

  .app-button--no-margin {
    margin-bottom: 8px !important;
  }
</style>


<!-- ðŸ”¹ Toggle button (ALWAYS visible) -->
<button
  type="button"
  class="govuk-button govuk-button--secondary app-button--no-margin"
  id="toggle-filters"
  aria-expanded="false"
  aria-controls="filters-wrapper">
  Show filters
</button>


<!-- ðŸ”¹ Wrapper containing BOTH applied filters + checkbox filter area -->
<div id="filters-wrapper" hidden>


  <!-- â­ APPLIED FILTERS (hidden initially, shown when filters open) -->
  <div class="app-applied-filters" id="applied-filters-section">

    <div class="app-applied-filters__header">
      <h3 class="govuk-heading-s govuk-!-margin-bottom-2">Active filters</h3>

      <a href="active" id="clear-filters-link" class="govuk-link">
        Clear filters
      </a>
    </div>

    <div class="app-applied-filters__chips">
      <div class="app-chip">
        <span>Appeal type: Householder</span>
        <button class="app-chip__remove">âœ•</button>
      </div>

      <div class="app-chip">
        <span>Action required: Questionnaire</span>
        <button class="app-chip__remove">âœ•</button>
      </div>
    </div>

  </div>


  <!-- â­ CHECKBOX FILTER OPTIONS -->
  <form method="get">

    <div id="filters-container" class="filters-container govuk-!-margin-top-2">

      <div class="filters-inner">

        <div class="filter-column">
          <h3 class="govuk-heading-s">Appeal type</h3>

          <div class="govuk-checkboxes govuk-checkboxes--small">

            <div class="govuk-checkboxes__item">
              <input class="govuk-checkboxes__input"
                     id="type-planning"
                     name="type"
                     value="Planning"
                     type="checkbox">
              <label class="govuk-label govuk-checkboxes__label"
                     for="type-planning">Advertisement</label>
            </div>

            <div class="govuk-checkboxes__item">
              <input class="govuk-checkboxes__input"
                     id="type-planning"
                     name="type"
                     value="Planning"
                     type="checkbox">
              <label class="govuk-label govuk-checkboxes__label"
                     for="type-planning">Commercial planning (CAS)</label>
            </div>

            <div class="govuk-checkboxes__item">
              <input class="govuk-checkboxes__input"
                     id="type-householder"
                     name="type"
                     value="Householder"
                     type="checkbox">
              <label class="govuk-label govuk-checkboxes__label"
                     for="type-householder">Enforcement notice</label>
            </div>

            <div class="govuk-checkboxes__item">
              <input class="govuk-checkboxes__input"
                     id="type-householder"
                     name="type"
                     value="Householder"
                     type="checkbox">
              <label class="govuk-label govuk-checkboxes__label"
                     for="type-householder">Householder</label>
            </div>
            
            <div class="govuk-checkboxes__item">
              <input class="govuk-checkboxes__input"
                     id="type-planning"
                     name="type"
                     value="Planning"
                     type="checkbox">
              <label class="govuk-label govuk-checkboxes__label"
                     for="type-planning">Planning</label>
            </div>


          </div>
        </div>


        <div class="filter-column">
          <h3 class="govuk-heading-s">Action required</h3>

          <div class="govuk-checkboxes govuk-checkboxes--small">

            <div class="govuk-checkboxes__item">
              <input class="govuk-checkboxes__input"
                     id="action-questionnaire"
                     name="action"
                     value="Questionnaire"
                     type="checkbox">
              <label class="govuk-label govuk-checkboxes__label"
                     for="action-questionnaire">Questionnaire</label>
            </div>

            <div class="govuk-checkboxes__item">
              <input class="govuk-checkboxes__input"
                     id="action-statement"
                     name="action"
                     value="Statement"
                     type="checkbox">
              <label class="govuk-label govuk-checkboxes__label"
                     for="action-statement">Statement</label>
            </div>

          </div>
        </div>

      </div>

      {{ govukButton({
        text: "Apply filters",
        href: "#",
        classes: "govuk-button govuk-!-margin-top-4 govuk-!-margin-bottom-0"
      }) }}

    </div>

  </form>

</div>


<!-- â­ Toggle + Clear behaviour -->
<script>
  const toggleButton = document.getElementById('toggle-filters');
  const wrapper = document.getElementById('filters-wrapper');
  const clearLink = document.getElementById('clear-filters-link');

  // Show/hide both applied filters + checkbox section together
  toggleButton.addEventListener('click', () => {
    const open = toggleButton.getAttribute('aria-expanded') === 'true';

    toggleButton.setAttribute('aria-expanded', !open);
    toggleButton.textContent = open ? 'Show filters' : 'Hide filters';
    wrapper.hidden = open;
  });

  // Hide EVERYTHING when Clear filters is selected
  clearLink.addEventListener('click', () => {
    wrapper.hidden = true;
    toggleButton.textContent = 'Show filters';
    toggleButton.setAttribute('aria-expanded', 'false');
  });
</script>
