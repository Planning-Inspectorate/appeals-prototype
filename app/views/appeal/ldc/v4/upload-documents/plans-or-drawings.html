{% extends '_layouts/layout-appellant-main.html' %}

{% set title = 'Upload your plans, drawings and supporting documents you submitted with your application' %}
{% set pageName = title + ' - Planning Inspectorate'%}

{% block questions %}

  <span class="govuk-caption-l">Upload documents</span>

  <h1 class="govuk-heading-l">
    {{ title }}
  </h1>

  <p class="govuk-body">
    You must upload all of the plans, drawings and supporting documents that you submitted to the local planning authority with your planning application. Do not include any new or updated documents. Weâ€™ll ask for these later.
  </p>

 

  {% set uploadHtml %}
    {{ govukFileUpload({
      id: 'decision-letter',
      name: 'decision-letter',
      classes: 'moj-multi-file-upload__input',
      label: {
        text: 'Upload files',
        classes: 'govuk-label--m'
      },
      hint: {
        text: 'Each file must be a DOC, DOCX, PDF, TIF, JPG or PNG and be smaller than 25MB'
      }
    }) }}

    {{govukButton({
      text: 'Upload files',
      classes: 'govuk-button--secondary moj-multi-file-upload__button'
    })}}
  {% endset %}

  {{ mojMultiFileUpload({
    uploadedFiles: {
      heading: { text: 'File added' },
      items: []
    },
    uploadHtml: uploadHtml
  }) }}
{% endblock %}

{% block pageScripts %}
  <script>
    // Hacky hacky single file
    $('.moj-multi-file-upload__dropzone .govuk-body').text('Drag and drop a file here or ')
    $('.moj-multi-file-upload__dropzone .govuk-button').text('Select file')
    $('.moj-multi-file__uploaded-files').on('fileAdded', function() {
      $('.moj-multi-file-upload__upload').hide()
    });

    $('.moj-multi-file__uploaded-files').click(function() {
      $('.moj-multi-file-upload__upload').show()
    });



    // I really should learn how the MOJ upload works, however, a hack to get all the files passed into data
    $('form').submit(function(e) {
      e.preventDefault();

      $('.moj-multi-file-upload__filename').each(function() {
        $('<input name="decision-letter" type="checkbox" value="'+ $(this).text() +'" checked="true" style="display: none">').insertBefore('.govuk-heading-l');
      });

      $(this).unbind('submit').submit();
    })
  </script>
{% endblock %}
{% block afterContent %}

  <p class="govuk-body govuk-!-margin-bottom-6">
     <a href="/your-appeal">Return to your appeal</a>
    </p>

{% endblock %}