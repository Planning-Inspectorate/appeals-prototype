{% extends '_layouts/layout-appellant-main.html' %}

{% set title = 'Upload your application form' %}
{% set pageName = title + ' - Planning Inspectorate'%}

{% block questions %}
	<div class="govuk-grid-row">
		<div class="govuk-grid-column-three-quarters govuk-grid-column-two-thirds-from-desktop">

			<form method="post">

  <span class="govuk-caption-l">Upload documents</span>

  <h1 class="govuk-heading-l">
    {{ title }}
  </h1>

  <p class="govuk-body">
    Upload the planning application form that you sent to the local planning authority, including the date. Do not upload a draft application.
  </p>

  <p class="govuk-body">
    If you do not have your application form, you can search for it on the local planning authorityâ€™s website.
  </p>

  {% set uploadHtml %}
    {{ govukFileUpload({
      id: 'application-form',
      name: 'application-form',
      classes: 'moj-multi-file-upload__input',
      label: {
        text: 'Upload a file',
        classes: 'govuk-label--m'
      },
      hint: {
        text: 'The file must be a DOC, DOCX, PDF, XLS, TIF, JPG or PNG and be smaller than 25MB'
      }
    }) }}

    {{govukButton({
      text: 'Upload file',
      classes: 'govuk-button--secondary moj-multi-file-upload__button'
    })}}
  {% endset %}

  {{ mojMultiFileUpload({
    uploadedFiles: {
      heading: { text: 'File added' },
      items: []
    },
    uploadHtml: uploadHtml
  }) }}
  {% endblock %}

		
			{% block afterContent %}
				<p class="govuk-body govuk-!-margin-bottom-6">
					<a href="/your-appeal">Return to your appeal</a>
				</p>
			{% endblock %}

      {% block pageScripts %}
  <script>
    // Hacky hacky single file
    $('.moj-multi-file-upload__dropzone .govuk-body').text('Drag and drop a file here or ')
    $('.moj-multi-file-upload__dropzone .govuk-button').text('Select file')
    $('.moj-multi-file__uploaded-files').on('fileAdded', function() {
      $('.moj-multi-file-upload__upload').hide()
      // When a file is added, change the continue button to submit the form
      var $btn = $('a.govuk-button:contains("Continue")')
      $btn.replaceWith('<button type="submit" class="govuk-button" data-module="govuk-button">Continue</button>')
      // Update form action to post to application-form
      $('form').attr('action', 'application-form')
    });

    $('.moj-multi-file__uploaded-files').click(function() {
      $('.moj-multi-file-upload__upload').show()
    });
  </script>
{% endblock %}
	
